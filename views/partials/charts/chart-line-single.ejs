<script type="text/javascript">
    var canvases = document.querySelectorAll('[data-chart-line-single]');

    function getChartData(rawdata, max) {
        var result = [];
        if (rawdata.length > max) {
            const interval = Math.ceil(rawdata.length/max);
            for(var i = 0; i < rawdata.length; i += interval) {
                result.push(rawdata[i].y);
            }
        }
        else {
            result = rawdata.map(x => x.y);
        }
        return result.reverse();
    }

    canvases.forEach(canvas => {
        const rawdata = JSON.parse(canvas.getAttribute('data-chart-line-single'));
        const data = getChartData(rawdata, 30);
        const labels = Array.from(Array(data.length).keys());
        var ctx = canvas.getContext('2d');
        var chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels,
                datasets: [{
                    data,
                    backgroundColor: ['rgba(54, 162, 235, 0.4)'],
                    borderColor: ['rgba(54, 162, 235, 1)'],
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 0,
                }],
            },
            options: {
                aspectRatio: 4,
                title: { display: false },
                legend: { display: false },
                scales: {
                    xAxes: [{
                        display: false,
                    }],
                    yAxes: [{
                        display: false,
                    }],
                },
                tooltips: { enabled: false },
            },
        })
    });
</script>