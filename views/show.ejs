<%- include("./partials/header"); %>

<div class="main-body">

<div class="total-overview">
    <div class="total-overview-header">
        <h1>Overview</h1>
    </div>
    <div class="total-overview-row">
    <% if ((portfolios === undefined) || (watchlists === undefined)) { %>
        <div class="error">An error occurred!</div>
    <% } else { %>
        <% const pstr = (portfolios.length == 1) ? 'portfolio' : 'portfolios'; %>
        <% const wstr = (watchlists.length == 1) ? 'watchlist' : 'watchlists'; %>
        <h3>(<%- portfolios.length %> <%- pstr %> and <%- watchlists.length %> <%- wstr %>)</h3>
    <% } %>
    </div>
</div>
            
<div class="panel-container-2c">
    <div class="panel-containee panel-border">
        <div class="title">
            <div class="mini-nav">
                <ul>
                    <li><button id="portfolios-add-button">Add Portfolio</button></li>
                    <li><a href="/show" title="Refresh" class="icon"><img src="/img/iconmonstr-synchronization-18.svg" alt="Refresh" class="button-svg"></a></li>
                </ul>
            </div>
        </div>
        <div class="content">
            <div class="standard-list">
                <% if (portfolios === undefined) { %>
                    <div class="error">An error occurred!</div>
                <% } else if (portfolios.length == 0) { %>
                    <div class="error">There are no portfolios!</div>
                <% } else { %>
                    <table class="sortable portfolios-list">
                        <thead>
                            <tr>
                                <th>Portfolio Name</th>
                                <th>Total Value</th>
                                <th>Cost Basis</th>
                                <th>Daily</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                    <% portfolios.forEach((portfolio) => { %>
                            <tr class="item">
                                <td sorttable_customkey="<%- portfolio.name %>">
                                    <div class="truncated">
                                        <a href="/portfolios/<%= portfolio._id %>"><%- portfolio.name %></a>
                                    </div>
                                </td>
                                <td sorttable_customkey="<%- portfolio.unrealized_value %>">
                                    <span class="format-currency-<%- portfolio.currency %>"><%- portfolio.unrealized_value %></span><br>
                                    <span class="format-percentage"><%- portfolio.unrealized_value_percentage %></span>
                                </td>
                                <td sorttable_customkey="<%- portfolio.cost_basis %>">
                                    <span class="format-currency-<%- portfolio.currency %>"><%- portfolio.cost_basis %></span>
                                </td>
                                <td sorttable_customkey="<%- portfolio.daily_value %>">
                                    <span class="format-currency-<%- portfolio.currency %>"><%- portfolio.daily_value %></span><br>
                                    <span class="format-percentage"><%- portfolio.daily_value %></span>
                                </td>
                                <td sorttable_customkey="<%- portfolio.total_value %>">
                                    <span class="format-currency-<%- portfolio.currency %>"><%- portfolio.total_value %></span><br>
                                    <span class="format-percentage"><%- portfolio.total_value_percentage %></span>
                                </td>
                            </tr>
                    <% }); %>
                        </tbody>
                    </table>
                <% } %>
            </div>            
        </div>
    </div>

    <div class="panel-containee panel-border">
        <div class="title">
            <div class="mini-nav">
                <ul>
                    <li><button id="watchlists-add-button">Add Watchlist</button></li>
                </ul>
            </div>
        </div>
        <div class="content">
            <div class="standard-list">
                <% if (watchlists === undefined) { %>
                    <div class="error">An error occurred!</div>
                <% } else if (watchlists.length == 0) { %>
                    <div class="error">There are no watchlists!</div>
                <% } else { %>
                    <table class="sortable watchlists-list">
                        <thead>
                            <tr>
                                <th>Watchlist Name</th>
                                <th>Stocks</th>
                                <th>Cryptos</th>
                                <th>Cash</th>
                            </tr>
                        </thead>
                        <tbody>
                    <% watchlists.forEach((watchlist) => { %>
                            <tr class="item">
                                <td sorttable_customkey="<%- watchlist.name %>">
                                    <div class="truncated">
                                        <a href="/watchlists/<%= watchlist._id %>"><%- watchlist.name %></a>
                                    </div>
                                </td>
                                <td><%- watchlist.stock_entries.length %></td>      
                                <td><%- watchlist.crypto_entries.length %></td>      
                                <td><%- watchlist.cash_entries.length %></td>      
                            </tr>
                    <% }); %>
                        </tbody>
                    </table>
                <% } %>
            </div>            
        </div>
    </div>

</div>

</div>


<%- include("./modal/portfolios-add"); %>
<%- include("./modal/watchlists-add"); %>

<%- include("./partials/footer"); %>
<%- include("./partials/formatters"); %>
